<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.odtn.owner.dao.mapper.OwnerMapper">
	<select id="login" parameterType="java.util.Map"
		resultType="com.odtn.owner.dto.OwnerDto">
		select * from owner where owner_key = #{owner_key} and
		user_num = #{user_num}
	</select>


	<select id="countOwnerKey" parameterType="long"
		resultType="String">
		select nvl(count(*), 0) from owner where owner_key =
		#{owner_key}
	</select>

	<select id="getOwnerData" parameterType="long"
		resultType="com.odtn.owner.dto.OwnerMainPageDto">
		select m.user_name, c.camp_name, c.address, c.hp, c.camp_link
		from owner o, member m , camp_data c
		where o.user_num = m.user_num and o.camp_id = c.camp_id
		and o.owner_key =
		#{owner_key}
	</select>

	<select id="getReservationList" parameterType="java.util.Map"
		resultType="com.odtn.reservation.dto.ReservationDto">
		select * from reservation where camp_id = #{camp_id} and camp_site_type = #{fee_name}
	</select>
	
	<select id="getReservationCountMap" parameterType="int" resultType="java.util.Map">
		select camp_site_type as title, nvl(count(*), 0) as result from reservation 
		where camp_id = #{camp_id} GROUP BY camp_site_type
	</select>
	
	<update id="updateCampData" parameterType="com.odtn.search.dto.SearchDto">
		update camp_data
		<set>
		camp_name = #{camp_name},
		title = #{title},
		camp_type = #{camp_type},
		tag = #{tag},
		<if test="main_image != ''">
			main_image = #{main_image},
		</if>
		address = #{address},
		hp = #{hp},
		location_type = #{location_type},
		operation_type = #{operation_type},
		operation_period = #{operation_period},
		operation_day = #{operation_day},
		camp_link = #{camp_link},
		<if test="main_image != ''">
			sub_image1 = #{sub_image1},
		</if>
		<if test="main_image != ''">
			sub_image2 = #{sub_image2},
		</if>
		<if test="main_image != ''">
			sub_image3 = #{sub_image3},
		</if>
		content = #{content},
		content_modified_date = #{content_modified_date},
		main_facilities = #{main_facilities},
		etc_facilities = #{etc_facilities},
		bottom_type = #{bottom_type},
		site_size = #{site_size},
		gramping_facilities = #{gramping_facilities},
		karaban_facilities = #{karaban_facilities},
		animal_access = #{animal_access},
		torch = #{torch}
		</set> 
		where camp_id = #{camp_id}
	</update>
</mapper>